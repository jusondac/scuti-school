<% content_for :title, "Agency Management" %>
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Agency Management</h1>
    <p class="mt-2 text-gray-600 dark:text-gray-300">Review and manage agency applications</p>
  </div>
  <!-- Stats Overview -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg border border-gray-200 dark:border-gray-700">
      <div class="p-5">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <svg class="h-6 w-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
            </svg>
          </div>
          <div class="ml-5 w-0 flex-1">
            <dl>
              <dt class="text-sm font-medium text-gray-500 dark:text-gray-400 truncate">Pending</dt>
              <dd class="text-2xl font-bold text-gray-900 dark:text-white"><%= @pending_agencies.count %></dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg border border-gray-200 dark:border-gray-700">
      <div class="p-5">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
          <div class="ml-5 w-0 flex-1">
            <dl>
              <dt class="text-sm font-medium text-gray-500 dark:text-gray-400 truncate">Approved</dt>
              <dd class="text-2xl font-bold text-gray-900 dark:text-white"><%= @approved_agencies.count %></dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg border border-gray-200 dark:border-gray-700">
      <div class="p-5">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </div>
          <div class="ml-5 w-0 flex-1">
            <dl>
              <dt class="text-sm font-medium text-gray-500 dark:text-gray-400 truncate">Rejected</dt>
              <dd class="text-2xl font-bold text-gray-900 dark:text-white"><%= @rejected_agencies.count %></dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg border border-gray-200 dark:border-gray-700">
      <div class="p-5">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <svg class="h-6 w-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
            </svg>
          </div>
          <div class="ml-5 w-0 flex-1">
            <dl>
              <dt class="text-sm font-medium text-gray-500 dark:text-gray-400 truncate">Total</dt>
              <dd class="text-2xl font-bold text-gray-900 dark:text-white"><%= @pending_agencies.count + @approved_agencies.count + @rejected_agencies.count %></dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Tabs -->
  <div class="mb-8">
    <div class="border-b border-gray-200 dark:border-gray-700">
      <nav class="-mb-px flex space-x-8" aria-label="Tabs">
        <button onclick="showTab('pending')" class="tab-button active-tab border-indigo-500 text-indigo-600 dark:text-indigo-400 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm" id="pending-tab">
          Pending Applications
          <span class="bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 ml-2 py-0.5 px-2.5 rounded-full text-xs font-medium"><%= @pending_agencies.count %></span>
        </button>
        <button onclick="showTab('approved')" class="tab-button border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm" id="approved-tab">
          Approved Agencies
          <span class="bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 ml-2 py-0.5 px-2.5 rounded-full text-xs font-medium"><%= @approved_agencies.count %></span>
        </button>
        <button onclick="showTab('rejected')" class="tab-button border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm" id="rejected-tab">
          Rejected Applications
          <span class="bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 ml-2 py-0.5 px-2.5 rounded-full text-xs font-medium"><%= @rejected_agencies.count %></span>
        </button>
      </nav>
    </div>
  </div>
  <!-- Pending Tab -->
  <div id="pending-content" class="tab-content">
    <%= form_with url: bulk_action_agencies_path, method: :post, local: true, id: "pending-bulk-form", class: "space-y-4" do |form| %>
      <% if @pending_agencies.any? %>
        <!-- Bulk Actions Bar -->
        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 flex items-center justify-between">
          <div class="flex items-center space-x-4">
            <label class="flex items-center">
              <input type="checkbox" id="select-all-pending" class="rounded border-gray-300 dark:border-gray-600 text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700" onchange="toggleAll('pending')">
              <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Select All</span>
            </label>
            <span id="pending-selected-count" class="text-sm text-gray-500 dark:text-gray-400">0 selected</span>
          </div>
          <div class="flex items-center space-x-2">
            <%= form.select :bulk_action, 
                options_for_select([
                  ['Select Action', ''],
                  ['Approve', 'approve'],
                  ['Reject', 'reject'],
                  ['Delete', 'delete']
                ]), 
                { prompt: false }, 
                { class: "rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm", id: "pending-bulk-action" } %>
            <%= form.submit "Apply", class: "bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md text-sm font-medium", 
                onclick: "return confirmBulkAction('pending')" %>
          </div>
        </div>
        <div class="bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-lg border border-gray-200 dark:border-gray-700">
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
              <thead class="bg-gray-50 dark:bg-gray-900">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                    <input type="checkbox" class="rounded border-gray-300 dark:border-gray-600 text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700" style="visibility: hidden;">
                  </th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Agency</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Contact</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Submitted</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                <% @pending_agencies.each do |agency| %>
                  <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <input type="checkbox" name="agency_ids[]" value="<%= agency.id %>" class="pending-checkbox rounded border-gray-300 dark:border-gray-600 text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700" onchange="updateSelectedCount('pending')">
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <div>
                        <div class="text-sm font-medium text-gray-900 dark:text-white"><%= agency.name %></div>
                        <div class="text-sm text-gray-500 dark:text-gray-400"><%= truncate(agency.description, length: 50) %></div>
                      </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <div>
                        <div class="text-sm text-gray-900 dark:text-white"><%= agency.email %></div>
                        <div class="text-sm text-gray-500 dark:text-gray-400"><%= agency.phone %></div>
                      </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                      <%= agency.created_at.strftime("%b %d, %Y") %>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                      <%= link_to agency, class: "text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300" do %>
                        View
                      <% end %>
                      <%= link_to approve_agency_path(agency), method: :post, data: { confirm: "Are you sure you want to approve this agency?" }, class: "text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300" do %>
                        Approve
                      <% end %>
                      <%= link_to reject_agency_path(agency), method: :post, data: { confirm: "Are you sure you want to reject this agency?" }, class: "text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300" do %>
                        Reject
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      <% else %>
        <div class="bg-white dark:bg-gray-800 shadow sm:rounded-lg border border-gray-200 dark:border-gray-700">
          <div class="px-4 py-5 sm:p-6 text-center">
            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
            </svg>
            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-white">No pending applications</h3>
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
              No agencies are waiting for approval.
            </p>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
  <!-- Approved Tab -->
  <div id="approved-content" class="tab-content hidden">
    <%= form_with url: bulk_action_agencies_path, method: :post, local: true, id: "approved-bulk-form", class: "space-y-4" do |form| %>
      <% if @approved_agencies.any? %>
        <!-- Bulk Actions Bar -->
        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 flex items-center justify-between">
          <div class="flex items-center space-x-4">
            <label class="flex items-center">
              <input type="checkbox" id="select-all-approved" class="rounded border-gray-300 dark:border-gray-600 text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700" onchange="toggleAll('approved')">
              <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Select All</span>
            </label>
            <span id="approved-selected-count" class="text-sm text-gray-500 dark:text-gray-400">0 selected</span>
          </div>
          <div class="flex items-center space-x-2">
            <%= form.select :bulk_action, 
                options_for_select([
                  ['Select Action', ''],
                  ['Delete', 'delete']
                ]), 
                { prompt: false }, 
                { class: "rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm", id: "approved-bulk-action" } %>
            <%= form.submit "Apply", class: "bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md text-sm font-medium", 
                onclick: "return confirmBulkAction('approved')" %>
          </div>
        </div>
        <div class="bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-lg border border-gray-200 dark:border-gray-700">
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
              <thead class="bg-gray-50 dark:bg-gray-900">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                    <input type="checkbox" class="rounded border-gray-300 dark:border-gray-600 text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700" style="visibility: hidden;">
                  </th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Agency</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Contact</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Approved</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                <% @approved_agencies.each do |agency| %>
                  <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <input type="checkbox" name="agency_ids[]" value="<%= agency.id %>" class="approved-checkbox rounded border-gray-300 dark:border-gray-600 text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700" onchange="updateSelectedCount('approved')">
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <div>
                        <div class="text-sm font-medium text-gray-900 dark:text-white"><%= agency.name %></div>
                        <div class="text-sm text-gray-500 dark:text-gray-400"><%= truncate(agency.description, length: 50) %></div>
                      </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <div>
                        <div class="text-sm text-gray-900 dark:text-white"><%= agency.email %></div>
                        <div class="text-sm text-gray-500 dark:text-gray-400"><%= agency.phone %></div>
                      </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                      <%= agency.updated_at.strftime("%b %d, %Y") %>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                      <%= link_to agency, class: "text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300" do %>
                        View
                      <% end %>
                      <%= link_to agency, method: :delete, data: { confirm: "Are you sure you want to delete this agency?" }, class: "text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300" do %>
                        Delete
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      <% else %>
        <div class="bg-white dark:bg-gray-800 shadow sm:rounded-lg border border-gray-200 dark:border-gray-700">
          <div class="px-4 py-5 sm:p-6 text-center">
            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
            </svg>
            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-white">No approved agencies</h3>
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
              No agencies have been approved yet.
            </p>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
  <!-- Rejected Tab -->
  <div id="rejected-content" class="tab-content hidden">
    <%= form_with url: bulk_action_agencies_path, method: :post, local: true, id: "rejected-bulk-form", class: "space-y-4" do |form| %>
      <% if @rejected_agencies.any? %>
        <!-- Bulk Actions Bar -->
        <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 flex items-center justify-between">
          <div class="flex items-center space-x-4">
            <label class="flex items-center">
              <input type="checkbox" id="select-all-rejected" class="rounded border-gray-300 dark:border-gray-600 text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700" onchange="toggleAll('rejected')">
              <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Select All</span>
            </label>
            <span id="rejected-selected-count" class="text-sm text-gray-500 dark:text-gray-400">0 selected</span>
          </div>
          <div class="flex items-center space-x-2">
            <%= form.select :bulk_action, 
                options_for_select([
                  ['Select Action', ''],
                  ['Approve', 'approve'],
                  ['Delete', 'delete']
                ]), 
                { prompt: false }, 
                { class: "rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm", id: "rejected-bulk-action" } %>
            <%= form.submit "Apply", class: "bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md text-sm font-medium", 
                onclick: "return confirmBulkAction('rejected')" %>
          </div>
        </div>
        <div class="bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-lg border border-gray-200 dark:border-gray-700">
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
              <thead class="bg-gray-50 dark:bg-gray-900">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                    <input type="checkbox" class="rounded border-gray-300 dark:border-gray-600 text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700" style="visibility: hidden;">
                  </th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Agency</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Contact</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Rejected</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                <% @rejected_agencies.each do |agency| %>
                  <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <input type="checkbox" name="agency_ids[]" value="<%= agency.id %>" class="rejected-checkbox rounded border-gray-300 dark:border-gray-600 text-indigo-600 focus:ring-indigo-500 dark:bg-gray-700" onchange="updateSelectedCount('rejected')">
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <div>
                        <div class="text-sm font-medium text-gray-900 dark:text-white"><%= agency.name %></div>
                        <div class="text-sm text-gray-500 dark:text-gray-400"><%= truncate(agency.description, length: 50) %></div>
                      </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <div>
                        <div class="text-sm text-gray-900 dark:text-white"><%= agency.email %></div>
                        <div class="text-sm text-gray-500 dark:text-gray-400"><%= agency.phone %></div>
                      </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                      <%= agency.updated_at.strftime("%b %d, %Y") %>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                      <%= link_to agency, class: "text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300" do %>
                        View
                      <% end %>
                      <%= link_to approve_agency_path(agency), method: :post, data: { confirm: "Are you sure you want to approve this agency?" }, class: "text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300" do %>
                        Approve
                      <% end %>
                      <%= link_to agency, method: :delete, data: { confirm: "Are you sure you want to delete this agency?" }, class: "text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300" do %>
                        Delete
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      <% else %>
        <div class="bg-white dark:bg-gray-800 shadow sm:rounded-lg border border-gray-200 dark:border-gray-700">
          <div class="px-4 py-5 sm:p-6 text-center">
            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-white">No rejected agencies</h3>
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
              No agencies have been rejected.
            </p>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
<script>
  // Tab functionality
  function showTab(tabName) {
    // Hide all tab contents
    const tabContents = document.querySelectorAll('.tab-content');
    tabContents.forEach(content => content.classList.add('hidden'));

    // Remove active class from all tabs
    const tabButtons = document.querySelectorAll('.tab-button');
    tabButtons.forEach(button => {
      button.classList.remove('active-tab', 'border-indigo-500', 'text-indigo-600', 'dark:text-indigo-400');
      button.classList.add('border-transparent', 'text-gray-500', 'dark:text-gray-400', 'hover:text-gray-700', 'dark:hover:text-gray-300', 'hover:border-gray-300', 'dark:hover:border-gray-600');
    });

    // Show selected tab content
    document.getElementById(tabName + '-content').classList.remove('hidden');

    // Add active class to selected tab
    const activeTab = document.getElementById(tabName + '-tab');
    activeTab.classList.add('active-tab', 'border-indigo-500', 'text-indigo-600', 'dark:text-indigo-400');
    activeTab.classList.remove('border-transparent', 'text-gray-500', 'dark:text-gray-400', 'hover:text-gray-700', 'dark:hover:text-gray-300', 'hover:border-gray-300', 'dark:hover:border-gray-600');
  }

  // Checkbox functionality
  function toggleAll(status) {
    const selectAllCheckbox = document.getElementById('select-all-' + status);
    const checkboxes = document.querySelectorAll('.' + status + '-checkbox');

    checkboxes.forEach(checkbox => {
      checkbox.checked = selectAllCheckbox.checked;
    });

    updateSelectedCount(status);
  }

  function updateSelectedCount(status) {
    const checkboxes = document.querySelectorAll('.' + status + '-checkbox:checked');
    const count = checkboxes.length;
    const countElement = document.getElementById(status + '-selected-count');
    const selectAllCheckbox = document.getElementById('select-all-' + status);
    const allCheckboxes = document.querySelectorAll('.' + status + '-checkbox');

    countElement.textContent = count + ' selected';

    // Update select all checkbox state
    if (count === 0) {
      selectAllCheckbox.checked = false;
      selectAllCheckbox.indeterminate = false;
    } else if (count === allCheckboxes.length) {
      selectAllCheckbox.checked = true;
      selectAllCheckbox.indeterminate = false;
    } else {
      selectAllCheckbox.checked = false;
      selectAllCheckbox.indeterminate = true;
    }
  }

  function confirmBulkAction(status) {
    const checkboxes = document.querySelectorAll('.' + status + '-checkbox:checked');
    const action = document.getElementById(status + '-bulk-action').value;

    if (checkboxes.length === 0) {
      alert('Please select at least one agency.');
      return false;
    }

    if (!action) {
      alert('Please select an action.');
      return false;
    }

    const count = checkboxes.length;
    const actionText = action === 'delete' ? 'delete' : action;

    return confirm(`Are you sure you want to ${actionText} ${count} selected ${count === 1 ? 'agency' : 'agencies'}?`);
  }

  // Initialize with pending tab active
  document.addEventListener('DOMContentLoaded', function() {
    showTab('pending');
  });
</script>
